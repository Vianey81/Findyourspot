{% extends 'base.html' %}
{% block title %}
    <title>Main Page</title>
{% endblock %}
{% block body %}

    <div class="site-wrapper">
    <div class="site-wrapper-inner">

        <h1>Let's Play!</h1>
        <div id="searchform" class="contaniner">
              <div class="row">
                
                <div class="panel panel-primary col-xs-12 col-md-3" style="height: 220px;">
                  <div class="panel-heading">
                    <h3 class="panel-title">Marital Status & Age</h3>
                  </div>
                  <div class="panel-body" >
                    <div class="col-xs-12 col-md-12">
                                <input type="range" min="0" max="2" style="width:100%;">
                                <output class="opcMarital" id="valor">4</output>
                            </div>

                            <div class="col-xs-12 col-md-12">
                                <label class="control-label">Age:</label>
                                    <select data-placeholder="Choose your Age" class="form-control chzn-select" id="age">
                                            <option value="1524">15 - 24 yrs</option>
                                            <option value="2539">25 - 39 yrs</option>
                                            <option value="4059">40 - 59 yrs</option>
                                            <option value="60">60 - 90 yrs</option>
                                    </select>
               
                            </div>
                            <div class="col-xs-12 col-md-12">
                                <label class="control-label">Marital Status</label>
                                    <select class="form-control" id="marital">                            
                                            <option value="single">Single</option>
                                            <option value="married">Married</option>
                                            <option value="widowed">Widowed</option>
                                            <option value="divorced">Divorced</option>                          
                                    </select>
                                </div>
                  </div>
                </div>
                
                                

                <div class="panel panel-success col-xs-12 col-md-3" style="height: 220px;">
                  <div class="panel-heading">
                    <h3 class="panel-title">Cost of Living</h3>
                  </div>
                  <div class="panel-body">
                    <div class="col-xs-12 col-md-12">
                                    <input type="range" min="0" max="2" style="width:100%;">
                                    <output class="opcLiving" id="valor" >4</output>
                                </div> 

                                <label class="control-label col-md-12">Legal Situation:</label>

                                <div class="col-md-12">
                                    <select class="form-control" id="tax">
                                        
                                            <option value="1ad">Living Alone</option>
                                            <option value="2ad">Living with a partner</option>
                                            <option value="22">Living with a partner with children</option>
                                        
                                    </select>
                                </div>
                  </div>
                </div>
                
                <div class="panel panel-info col-xs-12 col-md-3" style="height: 220px;">
                  <div class="panel-heading">
                    <h3 class="panel-title">Best Salary</h3>
                  </div>
                  <div class="panel-body">
                    <div class="col-xs-12 col-md-12">
                                    <input type="range" min="0" max="2" style="width:100%;">
                                    <output class="opcProfession" >4</output>
                                </div> 

                                    <div class="col-md-12">
                                        <label class="control-label">Professions:</label>
                                        <select data-placeholder="YOUR TEXT" class="form-control chzn-select" id="profession">
                                            {% for profession in professions %}
                                                <option value="{{ profession.title }}">{{ profession.title }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                  </div>
                </div>
                
                <div class="panel panel-warning col-xs-12 col-md-3" style="height: 220px;">
                  <div class="panel-heading">
                    <h3 class="panel-title">Crime</h3>
                  </div>
                  <div class="panel-body">
                    <div class="col-xs-12 col-md-12">
                                    <input type="range" min="0" max="2" style="width:100%;">
                                    <output class="opcCrime" id="valor">4</output>
                                </div>
                  </div>
                </div>
              
              </div>
        </div>


        <div id = "mapform" class="container">
            
        </div>
         <div id="details" class="hidden">
            {% raw %}
                <script id="template" type="text/html">
                  <h3>{{ name }}</h3>
                  <table>
                    <tr>
                      <th>Marital & Age:</th>
                      <td>{{ totalmarital }} </td>
                    </tr>
                    <tr>
                      <th>Cost of Living:</th>
                      <td>{{ livingrank }} %</td>
                    </tr>
                    <tr>
                      <th>Profession:</th>
                      <td>{{ professionrank }} %</td>
                    </tr>
                    <tr>
                      <th>Crime Rank:</th>
                      <td>{{ crimerank }} %</td>
                    </tr>
                    <tr>
                      <th>Total Rank:</th>
                      <td>{{ rate }} %</td>
                    </tr>
                  </table>
                </script>
        {% endraw %}
</div>

        <!-- <div id="charts" class="container">
          <div class="row">
              <body ng-app='nvd3TestApp'>
                <h1>Hello Plunker!</h1>
                <div ng-controller="ExampleCtrl">
                  <nvd3-line-chart
                    data="exampleData"
                    showXAxis="true"
                    showYAxis="true"
                    tooltips="true"
                    interactive="true">
                  </nvd3-line-chart>
                
                

                  <nvd3-pie-chart data="exampleData2"
                    id="exampleId"
                    width="550"
                    height="350"
                    x="xFunction()"
                    y="yFunction()"
                    showLabels="true"
                    showLegend="true">
                    <svg></svg>
                  </nvd3-pie-chart>
                </div>

              </body>
          </div>
        </div> -->
    
                
        <div id="infoform" class="container" >
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            DataTables Advanced Tables
                        </div>
                        <div class="panel-body">
                            <div >
                                <table id="example" class="display" cellspacing="0" width="100%">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Cost of Living</th>
                                            <th>Avg. Prof. Salary</th>
                                            <th>Marital & Age</th>
                                            <th>Crime</th>
                                            <th>Total</th>
                                        </tr>
                                    </thead>
                                    
                                </table>
                            </div>
                           
                        </div>
                    </div>
                </div>
        
        </div>

        
    </div>
</div>

<script>

    function valueOutput(element) {
        var value = element.value,
            output = element.parentNode.getElementsByTagName('output')[0];
        output.innerHTML = value * 4;
        
    }

    Array.prototype.slice.call(document.querySelectorAll('input[type="range"]')).forEach(function (el) {
            el.addEventListener('input', function (e) {
                valueOutput(e.target);
                loadNewData();
              
            }, false);
        });

    Array.prototype.slice.call(document.querySelectorAll('select')).forEach(function(el){
        el.addEventListener('input', function (e){
              loadNewData();
        }, false);
    });


    $(document).ready(function() {
      var tax = $('#tax').val();
      var profession = $('#profession').val();
      var age = $('#age').val();
      var marital = $('#marital').val();
      var wl = $('.opcLiving').val();
      var wp = $('.opcProfession').val();
      var wc = $('.opcCrime').val();
      var wm = $('.opcMarital').val();
      var url = "/search_states?tax="+tax+"&profession="+profession+"&age="+age+"&marital="+marital+"&opcLiving="+wl+"&opcMarital="+wm+"&opcCrime="+wc+"&opcProfession="+wp;

      var table = $('#example').dataTable( {
              "ajax": {
                "url": url,
                "type": "GET",
              },
              "columns": [
                { "data": "name" },
                { "data": "livingrank" },
                { "data": "professionrank" },
                { "data": "totalmarital" },
                { "data": "crimerank" },
                { "data": "rate" }
                ]
            } );

         
    } );


</script>



{% endblock %}